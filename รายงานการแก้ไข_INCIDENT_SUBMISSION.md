# р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓: р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з

**р╕зр╕▒р╕Щр╕Чр╕╡р╣И:** 15 р╕бр╕Бр╕гр╕▓р╕Др╕б 2569 р╣Ар╕зр╕ер╕▓ 14:19 р╕Щ.  
**р╕кр╕Цр╕▓р╕Щр╕░:** тЬЕ р╣Бр╕Бр╣Йр╣Др╕Вр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ  
**р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕гр╕╕р╕Щр╣Бр╕гр╕З:** ЁЯЯб р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З (р╕Вр╕▒р╕Фр╕Вр╕зр╕▓р╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М)

---

## ЁЯУЛ р╕кр╕гр╕╕р╕Ыр╕Ыр╕▒р╕Нр╕лр╕▓

р╣Ар╕Ир╣Йр╕▓р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕ар╕▓р╕Др╕кр╕Щр╕▓р╕бр╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╣Др╕Фр╣Й р╣Ар╕бр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕зр╕▓р╕Фр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ър╕Ър╕Щр╣Бр╕Ьр╕Щр╕Чр╕╡р╣И р╕гр╕░р╕Ър╕Ър╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф **500 Internal Server Error**

### ЁЯФ┤ р╕нр╕▓р╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╕Юр╕Ъ

```
POST /api/incidents тЖТ 500 Internal Server Error
```

**р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б Error р╣Гр╕Щ Console:**
```
тЭМ Error saving data: AxiosError
ЁЯУж Payload sent: {
  "affectedArea": null  // тЖР р╕Ыр╕▒р╕Нр╕лр╕▓: р╕кр╣Ир╕Зр╕Др╣Ир╕▓ null
}
ЁЯФ┤ Validation errors: Array(1)
```

---

## ЁЯФН р╕кр╕▓р╣Ар╕лр╕Хр╕╕р╕Вр╕нр╕Зр╕Ыр╕▒р╕Нр╕лр╕▓

р╕гр╕░р╕Ър╕Ъ Frontend р╕кр╣Ир╕Зр╕Др╣Ир╕▓ `affectedArea: null` р╣Ар╕бр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕зр╕▓р╕Фр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ р╣Бр╕Хр╣Ир╕гр╕░р╕Ър╕Ъ Backend р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е (DTO Validation) р╕Др╕▓р╕Фр╕лр╕зр╕▒р╕Зр╕зр╣Ир╕▓:

1. **р╕Цр╣Йр╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е**: р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ Object р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ GeoJSON Polygon р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
2. **р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е**: р╕Хр╣Йр╕нр╕З**р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Яр╕┤р╕ер╕Фр╣Мр╕Щр╕╡р╣Йр╕бр╕▓р╣Ар╕ер╕в** (р╣Др╕бр╣Ир╣Гр╕Кр╣Ир╕кр╣Ир╕Зр╕Др╣Ир╕▓ `null`)

р╣Ар╕бр╕╖р╣Ир╕нр╕кр╣Ир╕Зр╕Др╣Ир╕▓ `null` р╕бр╕▓ р╕Ир╕░р╣Др╕бр╣Ир╕Ьр╣Ир╕▓р╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `@IsObject()` р╣Ар╕Юр╕гр╕▓р╕░ `null` р╣Др╕бр╣Ир╣Гр╕Кр╣И object

### ЁЯУД р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З DTO р╕Вр╕нр╕З Backend

```typescript
@IsObject()
@IsOptional()
affectedArea?: any;  // Optional р╣Бр╕Хр╣Ир╕Цр╣Йр╕▓р╕бр╕╡р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ object
```

---

## тЬЕ р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В

р╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Яр╕ер╣М `frontend/src/pages/field-officer/SurveyReviewPage.tsx` р╣Гр╕лр╣Й**р╕кр╣Ир╕Зр╕Яр╕┤р╕ер╕Фр╣М `affectedArea` р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ**

### р╕Бр╣Ир╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В (тЭМ р╕Ьр╕┤р╕Ф)
```typescript
const payload = {
  // ... р╕Яр╕┤р╕ер╕Фр╣Мр╕нр╕╖р╣Ир╕Щр╣Ж
  affectedArea: surveyData.polygon,  // р╕нр╕▓р╕Ир╣Ар╕Ыр╣Зр╕Щ null
};
```

### р╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В (тЬЕ р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З)
```typescript
const payload: any = {
  // ... р╕Яр╕┤р╕ер╕Фр╣Мр╕нр╕╖р╣Ир╕Щр╣Ж
};

// р╕кр╣Ир╕Зр╕Яр╕┤р╕ер╕Фр╣М affectedArea р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е (р╣Др╕бр╣Ир╕кр╣Ир╕З null)
if (surveyData.polygon) {
  payload.affectedArea = surveyData.polygon;
}
```

---

## ЁЯУБ р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В

- тЬЕ `frontend/src/pages/field-officer/SurveyReviewPage.tsx` (р╕Ър╕гр╕гр╕Чр╕▒р╕Ф 246-263)

---

## ЁЯзк р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Чр╕│

- [ ] р╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М **р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕зр╕▓р╕Ф** р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ тЖТ р╕Хр╣Йр╕нр╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И
- [ ] р╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М **р╕Юр╕гр╣Йр╕нр╕бр╕зр╕▓р╕Ф** р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ тЖТ р╕Хр╣Йр╕нр╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕бр╣Ир╕бр╕╡ Error 500 р╣Гр╕Щ Console
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ър╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕нр╕вр╣Ир╕▓р╕Зр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З (р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╕зр╕▓р╕Ф)

---

## ЁЯУК р╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ

- **р╕Бр╣Ир╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В**: р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕лр╕▓р╕Бр╣Др╕бр╣Ир╕зр╕▓р╕Фр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ (р╕нр╕▒р╕Хр╕гр╕▓р╕Др╕зр╕▓р╕бр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з 100%)
- **р╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В**: р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕Чр╕▒р╣Йр╕Зр╕Бр╕гр╕Ур╕╡р╕бр╕╡р╣Бр╕ер╕░р╣Др╕бр╣Ир╕бр╕╡р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ъ (р╕нр╕▒р╕Хр╕гр╕▓р╕Др╕зр╕▓р╕бр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з 0%)

---

## ЁЯФз р╣Вр╕Др╣Йр╕Фр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З

### Backend DTO
**р╣Др╕Яр╕ер╣М**: `backend/src/incidents/dto/create-incident.dto.ts`
```typescript
@IsObject()
@IsOptional()
affectedArea?: any;  // р╕Яр╕┤р╕ер╕Фр╣М Optional - р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╣Гр╕лр╣Йр╣Др╕бр╣Ир╕кр╣Ир╕Зр╕бр╕▓
```

### р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Polygon Data
**р╣Др╕Яр╕ер╣М**: `frontend/src/pages/field-officer/CreateIncidentReportPage.tsx` (р╕Ър╕гр╕гр╕Чр╕▒р╕Ф 509)
```typescript
setPolygonData(geoJson.features && geoJson.features.length > 0 ? geoJson : null);
```

---

## ЁЯТб р╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щр╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ъ

р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕Щр╕╡р╣Йр╣Бр╕кр╕Фр╕Зр╣Гр╕лр╣Йр╣Ар╕лр╣Зр╕Щр╕Др╕зр╕▓р╕бр╕кр╕│р╕Др╕▒р╕Нр╕Вр╕нр╕З:

1. **р╣Др╕бр╣Ир╕Др╕зр╕гр╕кр╣Ир╕Зр╕Др╣Ир╕▓ `null` р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Яр╕┤р╕ер╕Фр╣М Optional р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ Object** - р╕Др╕зр╕гр╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Яр╕┤р╕ер╕Фр╣Мр╕Щр╕▒р╣Йр╕Щр╕бр╕▓р╣Ар╕ер╕в
2. **р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б Error р╕Ир╕▓р╕Б Backend р╕Др╕зр╕гр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щр╕Бр╕зр╣Ир╕▓р╕Щр╕╡р╣Й** (р╣Ар╕Кр╣Ир╕Щ "affectedArea р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ object р╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕кр╣Ир╕Зр╕бр╕▓")
3. **Frontend р╕Др╕зр╕гр╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╣Ир╕нр╕Щр╕кр╣Ир╕З** р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Ыр╕▒р╕Нр╕лр╕▓р╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Йр╕Хр╕▒р╣Йр╕Зр╣Бр╕Хр╣Ир╕Хр╣Йр╕Щ

---

## ЁЯУМ р╕кр╕Цр╕▓р╕Щр╕░

тЬЕ **р╣Бр╕Бр╣Йр╣Др╕Вр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ** - р╕Юр╕гр╣Йр╕нр╕бр╕Чр╕Фр╕кр╕нр╕Ъ

---

**р╕Ьр╕╣р╣Йр╕гр╕▓р╕вр╕Зр╕▓р╕Щ:** р╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓  
**р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕нр╕▒р╕Ыр╣Ар╕Фр╕Х:** 15 р╕бр╕Бр╕гр╕▓р╕Др╕б 2569 р╣Ар╕зр╕ер╕▓ 14:21 р╕Щ.
